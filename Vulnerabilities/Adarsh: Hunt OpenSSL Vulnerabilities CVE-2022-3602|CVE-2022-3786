Rule: Hunt OpenSSL Vulnerabilities(CVE-2022-3602|CVE-2022-3786)
Description: Last week #OpenSSL announced the release of OpenSSL version 3.0.7, to address a critical security vulnerability. 
The vulnerability is related to denial-of-service(#ddos) for systems that support client certificate-based authentication. An attacker could send a maliciously crafted certificate to a server that parses certificates as part of client authentication and crash the server. 
Developed by: Adarsh Pandey

Query 1: 

DeviceTvmSoftwareVulnerabilities
| where CveId in ("CVE-2022-3602", "CVE-2022-3786") // https://www.openssl.org/blog/blog/2022/11/01/email-address-overflows/
| summarize make_set(CveId) by DeviceName, SoftwareName, SoftwareVersion


Query 2:

DeviceTvmSoftwareVulnerabilities
| where SoftwareName contains "openssl"
| where SoftwareVersion startswith "3.0."
| where SoftwareVersion != @"3.0.7"
| summarize by DeviceName, SoftwareName, SoftwareVersion


Query 3:

DeviceTvmSoftwareInventory
| where SoftwareName contains "openssl"
| where SoftwareVersion startswith "3.0"
| where SoftwareVersion != @"3.0.7"
| project DeviceName, SoftwareName, SoftwareVersion



Mitigation: 
Upgrade to OpenSSL version 3.0.7 as soon as it is available.
