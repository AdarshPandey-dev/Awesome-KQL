// Spring Framework RCE vulnerability - SpringShell (CVE-2022-22965)
// Developed by Adarsh Pandey
// Spring4Shell is a zero-day vulnerability in the Spring Core Framework, SpringShell is a programming and configuration model for Java-based applications.
// MS365 Security & MS Sentinel Hunting KQL Query
CommonSecurityLog
| where RequestMethod == 'POST'
| where RequestURL has "/functionrouter" or RequestURL has "class.module.classLoader"
| where not(DeviceAction has_any ('built', 'deny', 'denied', 'rst', 'blocked', 'teardown', 'Block'))
